sower:
  enabled: true
  externalSecrets:
    createK8sPelicanServiceSecret: false
    createK8sSowerJobsSecret: true
    pelicanserviceG3auto: ci-pelicanservice-g3auto
  image:
    repository: quay.io/cdis/sower
    tag: integration202509
  replicaCount: 2
  serviceAccount:
    create: true
    name: sower-service-account
  sowerConfig:
  - action: export
    container:
      cpu-limit: '0.5'
      env:
      - name: DICTIONARY_URL
        valueFrom:
          configMapKeyRef:
            key: dictionary_url
            name: manifest-global
      - name: GEN3_HOSTNAME
        valueFrom:
          configMapKeyRef:
            key: hostname
            name: manifest-global
      - name: ROOT_NODE
        value: subject
      - name: DB_HOST
        valueFrom:
          secretKeyRef:
            key: host
            name: sheepdog-dbcreds
      - name: DB_DATABASE
        valueFrom:
          secretKeyRef:
            key: database
            name: sheepdog-dbcreds
      - name: DB_USER
        valueFrom:
          secretKeyRef:
            key: username
            name: sheepdog-dbcreds
      - name: DB_PASS
        valueFrom:
          secretKeyRef:
            key: password
            name: sheepdog-dbcreds
      - name: SHEEPDOG
        valueFrom:
          secretKeyRef:
            key: sheepdog
            name: indexd-service-creds
      image: quay.io/cdis/pelican-export:integration202509
      memory-limit: 1Gi
      name: job-task
      pull_policy: Always
      volumeMounts:
      - mountPath: /pelican-creds.json
        name: pelican-creds-volume
        readOnly: true
        subPath: config.json
    name: pelican-export
    restart_policy: Never
    volumes:
    - name: pelican-creds-volume
      secret:
        secretName: pelicanservice-g3auto
  - action: export-files
    container:
      cpu-limit: '0.5'
      env:
      - name: DICTIONARY_URL
        valueFrom:
          configMapKeyRef:
            key: dictionary_url
            name: manifest-global
      - name: GEN3_HOSTNAME
        valueFrom:
          configMapKeyRef:
            key: hostname
            name: manifest-global
      - name: ROOT_NODE
        value: file
      - name: EXTRA_NODES
        value: ''
      - name: DB_HOST
        valueFrom:
          secretKeyRef:
            key: host
            name: sheepdog-dbcreds
      - name: DB_DATABASE
        valueFrom:
          secretKeyRef:
            key: database
            name: sheepdog-dbcreds
      - name: DB_USER
        valueFrom:
          secretKeyRef:
            key: username
            name: sheepdog-dbcreds
      - name: DB_PASS
        valueFrom:
          secretKeyRef:
            key: password
            name: sheepdog-dbcreds
      - name: SHEEPDOG
        valueFrom:
          secretKeyRef:
            key: sheepdog
            name: indexd-service-creds
      image: quay.io/cdis/pelican-export:integration202509
      memory-limit: 1Gi
      name: job-task
      pull_policy: Always
      volumeMounts:
      - mountPath: /pelican-creds.json
        name: pelican-creds-volume
        readOnly: true
        subPath: config.json
    name: pelican-export-files
    restart_policy: Never
    volumes:
    - name: pelican-creds-volume
      secret:
        secretName: pelicanservice-g3auto
  - action: batch-export
    activeDealineSeconds: 600
    container:
      cpu-limit: '1'
      env:
      - name: BUCKET
        value: sower-jobs-bucket
      - name: GEN3_HOSTNAME
        valueFrom:
          configMapKeyRef:
            key: hostname
            name: manifest-global
      image: quay.io/cdis/batch-export:integration202509
      memory-limit: 1Gi
      name: job-task
      pull_policy: Always
    name: batch-export
    restart_policy: Never
    serviceAccountName: sower-service-account
